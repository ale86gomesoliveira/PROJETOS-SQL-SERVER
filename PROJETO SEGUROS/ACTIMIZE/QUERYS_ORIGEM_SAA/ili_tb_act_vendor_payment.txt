SELECT
(CONCAT(A.NR_SEQPAGTOCOMP, A.CD_AGENTE)) AS MESSAGE_KEY_ID,
A.VR_BRUTO AS BASE_CURR_AMOUNT_VL,
C.DT_CREDITOCOMP AS EXECUTION_GLOBAL_DH,
'' AS FULL_MESSAGE_TX,
'' AS ADDITIONAL_MESSAGE_INFO_TX,
'' AS MESSAGE_FORMAT_TX,
'' AS MESSAGE_INSTRUCTIONS_TX,
'' AS MESSAGE_REF_NR,
'' AS MESSAGE_SOURCE_TYPE_TX,
(CASE WHEN A.VR_BRUTO IS NOT NULL 
THEN 'BRL'
ELSE '' END) AS ORIG_CURR_CD,
'' AS ORIGINATOR_ADDRESS_LINE1_TX,
'' AS ORIGINATOR_ADDRESS_LINE2_TX,
'' AS ORIGINATOR_ADDRESS_LINE3_TX,
'' AS ORIGINATOR_CITY_NM,
'BR' AS ORIGINATOR_COUNTRY_CD,
'33061813000140' AS ORIGINATOR_DOC_NR,
'' AS ORIGINATOR_FI_COUNTRY_CD,
'' AS ORIGINATOR_FI_ORG_KEY_ID,
'' AS ORIGINATOR_FI_ORG_NM,
'PRUDENTIAL DO BRASIL SEGUROS DE VIDA S.A' AS ORIGINATOR_NM,
'PJ' AS ORIGINATOR_PARTY_TYPE_CD,
'' AS ORIGINATOR_PO_BOX_CD,
'' AS ORIGINATOR_STATE_PROVINCE_CD,
'' AS ORIGINATOR_ZIP_POSTCODE_CD,
'' AS ORIGINATOR_ADD_INFO_TX,
(CASE WHEN A.VR_BRUTO IS NOT NULL 
THEN 'BRL'
ELSE '' END) AS BENE_CURR_CD,
A.DS_ENDERECO AS BENEFICIARY_ADDRESS_LINE1_TX,
A.DS_BAIRRO AS BENEFICIARY_ADDRESS_LINE2_TX,
'' AS BENEFICIARY_ADDRESS_LINE3_TX,
A.DS_CIDADE AS BENEFICIARY_CITY_NM,
(CASE WHEN A.DS_ENDERECO IS NOT NULL 
THEN 'BR'
ELSE '' END) AS BENEFICIARY_COUNTRY_CD,
A.NR_CPFCNPJ AS BENEFICIARY_DOC_NR,
(CASE WHEN A.CD_BANCO IS NOT NULL 
THEN 'BR'
ELSE '' END) AS BENEFICIARY_FI_COUNTRY_CD,
A.CD_BANCO AS BENEFICIARY_FI_ORG_KEY_ID,
B.NM_BANCO AS BENEFICIARY_FI_ORG_NM,
A.NM_BENEFICIARIO AS BENEFICIARY_NM,
(CASE WHEN A.TP_NATJURSISPAG = 'J' 
THEN 'PJ'
WHEN A.TP_NATJURSISPAG = 'F'
THEN 'PF'
ELSE '' END) AS BENEFICIARY_PARTY_TYPE_CD,
'' AS BENEFICIARY_PO_BOX_CD,
A.CD_ESTADO AS BENEFICIARY_STATE_PROVINCE_CD,
A.NR_CEP AS BENEFICIARY_ZIP_POSTCODE_CD,
'' AS BENEFICIARY_ADD_INFO_TX,
'' AS INTERMEDIARY1_FI_COUNTRY_CD,
'' AS INTERMEDIARY1_FI_ORG_KEY_ID,
'' AS INTERMEDIARY1_FI_ORG_NM,
'' AS INTERMEDIARY2_FI_COUNTRY_CD,
'' AS INTERMEDIARY2_FI_ORG_KEY_ID,
'' AS INTERMEDIARY2_FI_ORG_NM,
'' AS INTERMEDIARY3_FI_COUNTRY_CD,
'' AS INTERMEDIARY3_FI_ORG_KEY_ID,
'' AS INTERMEDIARY3_FI_ORG_NM,
'' AS INTERMEDIARY4_FI_COUNTRY_CD,
'' AS INTERMEDIARY4_FI_ORG_KEY_ID,
'' AS INTERMEDIARY4_FI_ORG_NM,
'' AS INTERMEDIARY5_FI_COUNTRY_CD,
'' AS INTERMEDIARY5_FI_ORG_KEY_ID,
'' AS INTERMEDIARY5_FI_ORG_NM,
'' AS INTERMEDIARY6_FI_COUNTRY_CD,
'' AS INTERMEDIARY6_FI_ORG_KEY_ID,
'' AS INTERMEDIARY6_FI_ORG_NM,
'' AS INTERMEDIARY7_FI_COUNTRY_CD,
'' AS INTERMEDIARY7_FI_ORG_KEY_ID,
'' AS INTERMEDIARY7_FI_ORG_NM,
'' AS INTERMEDIARY8_FI_COUNTRY_CD,
'' AS INTERMEDIARY8_FI_ORG_KEY_ID,
'' AS INTERMEDIARY8_FI_ORG_NM,
'' AS PRODUCT_KEY_ID,
'' AS SENDING_FI_COUNTRY_CD,
'' AS SENDING_FI_ORG_KEY_ID,
'' AS SENDING_FI_ORG_NM,
'' AS SENDING_FI_ADD_INFO_TX,
(CASE WHEN A.CD_BANCO IS NOT NULL
THEN 'BR'
ELSE '' END) AS RECEIVING_FI_COUNTRY_CD,
A.CD_BANCO AS RECEIVING_FI_ORG_KEY_ID,
B.NM_BANCO AS RECEIVING_FI_ORG_NM,
'' AS RECEIVING_FI_ADD_INFO_TX,
'' AS FI_TO_FI_INFO_TX,
'BR' AS TENANT_CD,
(CASE WHEN A.TP_FORMAPAGTOCOMP = '1'
THEN 'CrÃ©dito em Conta'
WHEN A.TP_FORMAPAGTOCOMP = '2'
THEN 'Cheque'
WHEN A.TP_FORMAPAGTOCOMP = '3'
THEN 'Cheque'
WHEN A.TP_FORMAPAGTOCOMP = '4'
THEN 'Pix'
ELSE '' END)AS TRANSACTION_CODE_CD,
'SAA' AS SOURCE_SYSTEM_CD

FROM SAA.PAGTOCOMPAGENTE A

LEFT JOIN SAA.BANCO B
ON A.CD_OPERACAO = B.CD_OPERACAO
AND A.CD_BANCO = B.CD_BANCO

LEFT JOIN SAA.PAGTOCOMP D
ON A.CD_OPERACAO = D.CD_OPERACAO
AND A.NR_SEQPAGTOCOMP = D.NR_SEQPAGTOCOMP

LEFT JOIN SAA.CALENDARIOCOMP C
ON C.CD_OPERACAO = D.CD_OPERACAO
AND C.NR_SEQCALENDCOMP = D.NR_SEQCALENDCOMP

WHERE A.CD_OPERACAO = 'POB'
AND A.FG_REMESSAEXPORTADA = 'N'
AND A.VR_BRUTO > 0